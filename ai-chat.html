<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://js.puter.com/v2/"></script>
    <script>
      window.onload = () => {
        AIReady.postMessage("ready");
        console.log("✅ AIReady posted to Flutter");
      };

      window.chatWithAI = async function(message) {
        console.log("📥 Received message from Flutter:", message);

        try {
          const res = await puter.ai.chat(message, { model: "gpt-4.1-nano" });
          console.log("💬 Raw AI response:", res);

          if (res?.choices?.[0]?.message?.content) {
            return res.choices[0].message.content;
          } else if (res?.text) {
            return res.text;
          } else {
            return JSON.stringify(res);
          }
        } catch (e) {
          console.log("❌ Error in chatWithAI:", e);
          return "❌ AI Error: " + e.message;
        }
      };
    </script>
  </head>
  <body>
    <p style="font-family:sans-serif">AI Chatbot Loaded</p>
  </body>
</html>
